<!-- Page generated 2021-11-17 12:37:13 +0000-->
<!DOCTYPE html>
<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>
<title>docker buildx build | Docker Documentation</title>
  <meta name="description" content="docker buildx build: The `buildx build` command starts a build using BuildKit. This command is similar to the UI of `docker build` command and takes the same flags and arguments...." />
  <meta name="keywords" content="docker, docker open source, docker platform, distributed applications, microservices, containers, docker containers, docker software, docker virtualization">
  <link rel="canonical" href="https://docs.docker.com/engine/reference/commandline/buildx_build/" />

  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/favicons/docs@2x.ico" sizes="129x128">
  <link rel="apple-touch-icon" type="image/x-icon" href="/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/favicons/docs@2x.ico">
  <meta property="og:image" content="/favicons/docs@2x.ico"/>
  <meta name="theme-color" content="#2496ed" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- hide elements that are only shown without JavaScript enabled -->
  <script>document.documentElement.classList.add('js')</script>
  <style>html.js .no-js { display: none !important; }</style><script defer src="/js/theme-switcher.js"></script>
  <script defer src="/js/anchorlinks.js"></script>
  <script defer src="/js/jquery.js"></script>
  <script defer src="/js/bootstrap.min.js"></script>
  <script defer src="/js/docs.js"></script><script defer src="/js/search.js"></script><link rel="preload" as="font" href="https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFVZ0bf8pkAg.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/fonts/geomanist/hinted-Geomanist-Book.woff2"    type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/fonts/geomanist/hinted-Geomanist-Regular.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/fonts/glyphicons-halflings-regular.woff2"       type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/fonts/fontawesome-webfont.woff2?v=4.7.0"        type="font/woff2" crossorigin="anonymous">

  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css" id="pagestyle">

  <!-- SEO stuff -->
  <meta name="twitter:title" itemprop="title name" content="docker buildx build"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="docker buildx build: The `buildx build` command starts a build using BuildKit. This command is similar to the UI of `docker build` command and takes the same flags and arguments...." />
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:domain" content="docs.docker.com"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:image:src" content="https://docs.docker.com/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker Documentation"/>
  <meta property="og:title" content="docker buildx build" />
  <meta property="og:description" content="docker buildx build: The `buildx build` command starts a build using BuildKit. This command is similar to the UI of `docker build` command and takes the same flags and arguments...." />
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2021-11-17T12:37:13+00:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="https://docs.docker.com/images/docs@2x.png"/>
  <meta property="og:locale" content="en_US" />
  <meta property="og:url" content="https://docs.docker.com/engine/reference/commandline/buildx_build/" />
  <meta property="og:site_name" content="Docker Documentation" />
  <meta property="article:published_time" itemprop="datePublished" content="2021-11-17T12:37:13+00:00"/>
  <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"docker buildx build","description":"docker buildx build: The `buildx build` command starts a build using BuildKit. This command is similar to the UI of `docker build` command and takes the same flags and arguments....","url":"https://docs.docker.com/engine/reference/commandline/buildx_build/"}</script>
  <!-- END SEO STUFF -->
</head>
<body class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/">
                <img class="logo" src="/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs" width="160" height="28" />
            </a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="logo-mobile">
    <a href="/">
        <img src="/images/docker-icon.svg" alt="Docker Docs" title="Docker Docs" width="30" height="30" />
    </a>
</div>
<div class="search-form" id="search-div">
    <form class="search-form form-inline" id="searchForm" action="/search/" method="get">
        <label for="st-search-input" class="sr-only">Search</label>
        <input class="search-field form-control ds-input" id="st-search-input" name="q" placeholder="Search the docs" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteResults"></div>
        <!-- <button type="submit" class="search-submit btn btn-default">Search</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container hidden-sm hidden-xs">
    <div>
        <ul class="nav navbar-nav"><li><a href="/" id="home">Home</a></li><li><a href="/get-started/overview/" id="guides">Guides</a></li><li><a href="/desktop/" id="manuals">Manuals</a></li><li><a href="/reference/" id="reference">Reference</a></li><li><a href="/samples/" id="samples">Samples</a></li></ul>
    </div>
    <div class="ctrl-right">
        <a href="javascript:void(0)" id="menu-toggle" aria-label="Current page's menu toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
    </div>
</div>
<div class="row hidden-sm hidden-xs">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li><a href="/" title="Docker docs homepage"><i class="fa fa-home"></i></a></li>
            <li><a href="/reference/">Reference</a></li><li><a>Command-line reference</a></li><li><a href="/engine/reference/run/">Docker CLI (docker)</a></li><li><a href="/engine/reference/commandline/buildx/">docker buildx</a></li><li><a href="/engine/reference/commandline/buildx_build/">docker buildx build</a></li></ol>
    </nav>
</div></div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section"><h1>docker buildx build</h1><!--
This page is automatically generated from Docker's source code. If you want to
suggest a change to the text that appears here, open a ticket or pull request
in the source repository on GitHub:

https://github.com/docker/buildx
-->
<!-- Make sure atom is using hard tabs -->

<h2 id="description">Description</h2>

<p>Start a build</p>

<h2 id="usage">Usage</h2>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker buildx build <span class="o">[</span>OPTIONS] PATH | URL | -
</code></pre></div></div>

<h2 id="extended-description">Extended description</h2>

<p>The <code class="highlighter-rouge">buildx build</code> command starts a build using BuildKit. This command is similar
to the UI of <code class="highlighter-rouge">docker build</code> command and takes the same flags and arguments.</p>

<p>For documentation on most of these flags, refer to the <a href="/engine/reference/commandline/build/"><code class="highlighter-rouge">docker build</code>
documentation</a>. In
here we’ll document a subset of the new flags.</p>

<p>For example uses of this command, refer to the <a href="#examples">examples section</a> below.</p>

<h2 id="options">Options</h2>

<table>
<thead>
  <tr>
    <td>Name, shorthand</td>
    <td>Default</td>
    <td>Description</td>
  </tr>
</thead>
<tbody>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="/engine/reference/commandline/build/#add-entries-to-container-hosts-file---add-host"><code class="highlighter-rouge">--add-host</code></a></td>
    <td></td>
    <td>Add a custom host-to-IP mapping (host:ip)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="#allow"><code class="highlighter-rouge">--allow</code></a></td>
    <td></td>
    <td>Allow extra privileged entitlement, e.g. network.host, security.insecure</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="/engine/reference/commandline/build/#set-build-time-variables---build-arg"><code class="highlighter-rouge">--build-arg</code></a></td>
    <td></td>
    <td>Set build-time variables</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="#cache-from"><code class="highlighter-rouge">--cache-from</code></a></td>
    <td></td>
    <td>External cache sources (eg. user/app:cache, type=local,src=path/to/dir)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="#cache-to"><code class="highlighter-rouge">--cache-to</code></a></td>
    <td></td>
    <td>Cache export destinations (eg. user/app:cache, type=local,dest=path/to/dir)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--cgroup-parent</code></td>
    <td></td>
    <td>Optional parent cgroup for the container</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--compress</code></td>
    <td></td>
    <td>Compress the build context using gzip</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--cpu-period</code></td>
    <td></td>
    <td>Limit the CPU CFS (Completely Fair Scheduler) period</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--cpu-quota</code></td>
    <td></td>
    <td>Limit the CPU CFS (Completely Fair Scheduler) quota</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--cpu-shares</code> , <code class="highlighter-rouge">-c</code></td>
    <td></td>
    <td>CPU shares (relative weight)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--cpuset-cpus</code></td>
    <td></td>
    <td>CPUs in which to allow execution (0-3, 0,1)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--cpuset-mems</code></td>
    <td></td>
    <td>MEMs in which to allow execution (0-3, 0,1)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="/engine/reference/commandline/build/#specify-a-dockerfile--f"><code class="highlighter-rouge">--file</code></a> , <a href="/engine/reference/commandline/build/#specify-a-dockerfile--f"><code class="highlighter-rouge">-f</code></a></td>
    <td></td>
    <td>Name of the Dockerfile (Default is 'PATH/Dockerfile')</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--force-rm</code></td>
    <td></td>
    <td>Always remove intermediate containers</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--iidfile</code></td>
    <td></td>
    <td>Write the image ID to the file</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--isolation</code></td>
    <td></td>
    <td>Container isolation technology</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--label</code></td>
    <td></td>
    <td>Set metadata for an image</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="#load"><code class="highlighter-rouge">--load</code></a></td>
    <td></td>
    <td>Shorthand for --output=type=docker</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--memory</code> , <code class="highlighter-rouge">-m</code></td>
    <td></td>
    <td>Memory limit</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--memory-swap</code></td>
    <td></td>
    <td>Swap limit equal to memory plus swap: '-1' to enable unlimited swap</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--network</code></td>
    <td></td>
    <td>Set the networking mode for the RUN instructions during build</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--no-cache</code></td>
    <td></td>
    <td>Do not use cache when building the image</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="#output"><code class="highlighter-rouge">--output</code></a> , <a href="#output"><code class="highlighter-rouge">-o</code></a></td>
    <td></td>
    <td>Output destination (format: type=local,dest=path)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="#platform"><code class="highlighter-rouge">--platform</code></a></td>
    <td></td>
    <td>Set target platform for build</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--progress</code></td>
    <td><code class="highlighter-rouge">auto</code></td>
    <td>Set type of progress output (auto, plain, tty). Use plain to show container output</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--pull</code></td>
    <td></td>
    <td>Always attempt to pull a newer version of the image</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="#push"><code class="highlighter-rouge">--push</code></a></td>
    <td></td>
    <td>Shorthand for --output=type=registry</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--quiet</code> , <code class="highlighter-rouge">-q</code></td>
    <td></td>
    <td>Suppress the build output and print image ID on success</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--rm</code></td>
    <td><code class="highlighter-rouge">true</code></td>
    <td>Remove intermediate containers after a successful build</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--secret</code></td>
    <td></td>
    <td>Secret file to expose to the build: id=mysecret,src=/local/secret</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--security-opt</code></td>
    <td></td>
    <td>Security options</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--shm-size</code></td>
    <td></td>
    <td>Size of /dev/shm</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--squash</code></td>
    <td></td>
    <td>Squash newly built layers into a single new layer</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--ssh</code></td>
    <td></td>
    <td>SSH agent socket or keys to expose to the build (format: default|&lt;id&gt;[=&lt;socket&gt;|&lt;key&gt;[,&lt;key&gt;]])</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="/engine/reference/commandline/build/#tag-an-image--t"><code class="highlighter-rouge">--tag</code></a> , <a href="/engine/reference/commandline/build/#tag-an-image--t"><code class="highlighter-rouge">-t</code></a></td>
    <td></td>
    <td>Name and optionally a tag in the 'name:tag' format</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><a href="/engine/reference/commandline/build/#specifying-target-build-stage---target"><code class="highlighter-rouge">--target</code></a></td>
    <td></td>
    <td>Set the target build stage to build.</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--ulimit</code></td>
    <td></td>
    <td>Ulimit options</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--builder</code></td>
    <td></td>
    <td>Override the configured builder instance</td>
  </tr>
 <!-- end for option -->
</tbody>
</table>
<p><!-- end if options --></p>

<h2 id="examples">Examples</h2>

<h3 id="platform">Set the target platforms for the build (--platform)</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--platform=value[,value]
</code></pre></div></div>

<p>Set the target platform for the build. All <code class="highlighter-rouge">FROM</code> commands inside the Dockerfile
without their own <code class="highlighter-rouge">--platform</code> flag will pull base images for this platform and
this value will also be the platform of the resulting image. The default value
will be the current platform of the buildkit daemon.</p>

<p>When using <code class="highlighter-rouge">docker-container</code> driver with <code class="highlighter-rouge">buildx</code>, this flag can accept multiple
values as an input separated by a comma. With multiple values the result will be
built for all of the specified platforms and joined together into a single manifest
list.</p>

<p>If the <code class="highlighter-rouge">Dockerfile</code> needs to invoke the <code class="highlighter-rouge">RUN</code> command, the builder needs runtime
support for the specified platform. In a clean setup, you can only execute <code class="highlighter-rouge">RUN</code>
commands for your system architecture.
If your kernel supports <a href="https://en.wikipedia.org/wiki/Binfmt_misc"><code class="highlighter-rouge">binfmt_misc</code></a>
launchers for secondary architectures, buildx will pick them up automatically.
Docker desktop releases come with <code class="highlighter-rouge">binfmt_misc</code> automatically configured for <code class="highlighter-rouge">arm64</code>
and <code class="highlighter-rouge">arm</code> architectures. You can see what runtime platforms your current builder
instance supports by running <code class="highlighter-rouge">docker buildx inspect --bootstrap</code>.</p>

<p>Inside a <code class="highlighter-rouge">Dockerfile</code>, you can access the current platform value through
<code class="highlighter-rouge">TARGETPLATFORM</code> build argument. Please refer to the <a href="/engine/reference/builder/#automatic-platform-args-in-the-global-scope"><code class="highlighter-rouge">docker build</code>
documentation</a>
for the full description of automatic platform argument variants .</p>

<p>The formatting for the platform specifier is defined in the <a href="https://github.com/containerd/containerd/blob/v1.4.3/platforms/platforms.go#L63">containerd source
code</a>.</p>

<p><strong>Examples</strong></p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker buildx build <span class="nt">--platform</span><span class="o">=</span>linux/arm64 <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">--platform</span><span class="o">=</span>linux/amd64,linux/arm64,linux/arm/v7 <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">--platform</span><span class="o">=</span>darwin <span class="nb">.</span>
</code></pre></div></div>

<h3 id="output">Set the export action for the build result (-o, --output)</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-o, --output=[PATH,-,type=TYPE[,KEY=VALUE]
</code></pre></div></div>

<p>Sets the export action for the build result. In <code class="highlighter-rouge">docker build</code> all builds finish
by creating a container image and exporting it to <code class="highlighter-rouge">docker images</code>. <code class="highlighter-rouge">buildx</code> makes
this step configurable allowing results to be exported directly to the client,
oci image tarballs, registry etc.</p>

<p>Buildx with <code class="highlighter-rouge">docker</code> driver currently only supports local, tarball exporter and
image exporter. <code class="highlighter-rouge">docker-container</code> driver supports all the exporters.</p>

<p>If just the path is specified as a value, <code class="highlighter-rouge">buildx</code> will use the local exporter
with this path as the destination. If the value is “-“, <code class="highlighter-rouge">buildx</code> will use <code class="highlighter-rouge">tar</code>
exporter and write to <code class="highlighter-rouge">stdout</code>.</p>

<p><strong>Examples</strong></p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker buildx build <span class="nt">-o</span> <span class="nb">.</span> <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">-o</span> outdir <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">-o</span> - - <span class="o">&gt;</span> out.tar
<span class="gp">$</span> docker buildx build <span class="nt">-o</span> <span class="nb">type</span><span class="o">=</span>docker <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">-o</span> <span class="nb">type</span><span class="o">=</span>docker,dest<span class="o">=</span>- <span class="nb">.</span> <span class="o">&gt;</span> myimage.tar
<span class="gp">$</span> docker buildx build <span class="nt">-t</span> tonistiigi/foo <span class="nt">-o</span> <span class="nb">type</span><span class="o">=</span>registry
</code></pre></div></div>

<p>Supported exported types are:</p>

<h4 id="local"><code class="highlighter-rouge">local</code></h4>

<p>The <code class="highlighter-rouge">local</code> export type writes all result files to a directory on the client. The
new files will be owned by the current user. On multi-platform builds, all results
will be put in subdirectories by their platform.</p>

<p>Attribute key:</p>

<ul>
  <li><code class="highlighter-rouge">dest</code> - destination directory where files will be written</li>
</ul>

<h4 id="tar"><code class="highlighter-rouge">tar</code></h4>

<p>The <code class="highlighter-rouge">tar</code> export type writes all result files as a single tarball on the client.
On multi-platform builds all results will be put in subdirectories by their platform.</p>

<p>Attribute key:</p>

<ul>
  <li><code class="highlighter-rouge">dest</code> - destination path where tarball will be written. “-” writes to stdout.</li>
</ul>

<h4 id="oci"><code class="highlighter-rouge">oci</code></h4>

<p>The <code class="highlighter-rouge">oci</code> export type writes the result image or manifest list as an <a href="https://github.com/opencontainers/image-spec/blob/v1.0.1/image-layout.md">OCI image
layout</a>
tarball on the client.</p>

<p>Attribute key:</p>

<ul>
  <li><code class="highlighter-rouge">dest</code> - destination path where tarball will be written. “-” writes to stdout.</li>
</ul>

<h4 id="docker"><code class="highlighter-rouge">docker</code></h4>

<p>The <code class="highlighter-rouge">docker</code> export type writes the single-platform result image as a <a href="https://github.com/docker/docker/blob/v20.10.2/image/spec/v1.2.md">Docker image
specification</a>
tarball on the client. Tarballs created by this exporter are also OCI compatible.</p>

<p>Currently, multi-platform images cannot be exported with the <code class="highlighter-rouge">docker</code> export type.
The most common usecase for multi-platform images is to directly push to a registry
(see <a href="#registry"><code class="highlighter-rouge">registry</code></a>).</p>

<p>Attribute keys:</p>

<ul>
  <li><code class="highlighter-rouge">dest</code> - destination path where tarball will be written. If not specified the
tar will be loaded automatically to the current docker instance.</li>
  <li><code class="highlighter-rouge">context</code> - name for the docker context where to import the result</li>
</ul>

<h4 id="image"><code class="highlighter-rouge">image</code></h4>

<p>The <code class="highlighter-rouge">image</code> exporter writes the build result as an image or a manifest list. When
using <code class="highlighter-rouge">docker</code> driver the image will appear in <code class="highlighter-rouge">docker images</code>. Optionally, image
can be automatically pushed to a registry by specifying attributes.</p>

<p>Attribute keys:</p>

<ul>
  <li><code class="highlighter-rouge">name</code> - name (references) for the new image.</li>
  <li><code class="highlighter-rouge">push</code> - boolean to automatically push the image.</li>
</ul>

<h4 id="registry"><code class="highlighter-rouge">registry</code></h4>

<p>The <code class="highlighter-rouge">registry</code> exporter is a shortcut for <code class="highlighter-rouge">type=image,push=true</code>.</p>

<h3 id="push">Push the build result to a registry (--push)</h3>

<p>Shorthand for <a href="#registry"><code class="highlighter-rouge">--output=type=registry</code></a>. Will automatically push the
build result to registry.</p>

<h3 id="load">Load the single-platform build result to <code class="highlighter-rouge">docker images</code> (--load)</h3>

<p>Shorthand for <a href="#docker"><code class="highlighter-rouge">--output=type=docker</code></a>. Will automatically load the
single-platform build result to <code class="highlighter-rouge">docker images</code>.</p>

<h3 id="cache-from">Use an external cache source for a build (--cache-from)</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--cache-from=[NAME|type=TYPE[,KEY=VALUE]]
</code></pre></div></div>

<p>Use an external cache source for a build. Supported types are <code class="highlighter-rouge">registry</code> and <code class="highlighter-rouge">local</code>.
The <code class="highlighter-rouge">registry</code> source can import cache from a cache manifest or (special) image
configuration on the registry. The <code class="highlighter-rouge">local</code> source can import cache from local
files previously exported with <code class="highlighter-rouge">--cache-to</code>.</p>

<p>If no type is specified, <code class="highlighter-rouge">registry</code> exporter is used with a specified reference.</p>

<p><code class="highlighter-rouge">docker</code> driver currently only supports importing build cache from the registry.</p>

<p><strong>Examples</strong></p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker buildx build <span class="nt">--cache-from</span><span class="o">=</span>user/app:cache <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">--cache-from</span><span class="o">=</span>user/app <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">--cache-from</span><span class="o">=</span><span class="nb">type</span><span class="o">=</span>registry,ref<span class="o">=</span>user/app <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">--cache-from</span><span class="o">=</span><span class="nb">type</span><span class="o">=</span><span class="nb">local</span>,src<span class="o">=</span>path/to/cache <span class="nb">.</span>
</code></pre></div></div>

<h3 id="cache-to">Export build cache to an external cache destination (--cache-to)</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--cache-to=[NAME|type=TYPE[,KEY=VALUE]]
</code></pre></div></div>

<p>Export build cache to an external cache destination. Supported types are <code class="highlighter-rouge">registry</code>,
<code class="highlighter-rouge">local</code> and <code class="highlighter-rouge">inline</code>. Registry exports build cache to a cache manifest in the
registry, local exports cache to a local directory on the client and inline writes
the cache metadata into the image configuration.</p>

<p><code class="highlighter-rouge">docker</code> driver currently only supports exporting inline cache metadata to image
configuration. Alternatively, <code class="highlighter-rouge">--build-arg BUILDKIT_INLINE_CACHE=1</code> can be used
to trigger inline cache exporter.</p>

<p>Attribute key:</p>

<ul>
  <li><code class="highlighter-rouge">mode</code> - Specifies how many layers are exported with the cache. “min” on only
exports layers already in the final build stage, “max” exports layers for
all stages. Metadata is always exported for the whole build.</li>
</ul>

<p><strong>Examples</strong></p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker buildx build <span class="nt">--cache-to</span><span class="o">=</span>user/app:cache <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">--cache-to</span><span class="o">=</span><span class="nb">type</span><span class="o">=</span>inline <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">--cache-to</span><span class="o">=</span><span class="nb">type</span><span class="o">=</span>registry,ref<span class="o">=</span>user/app <span class="nb">.</span>
<span class="gp">$</span> docker buildx build <span class="nt">--cache-to</span><span class="o">=</span><span class="nb">type</span><span class="o">=</span><span class="nb">local</span>,dest<span class="o">=</span>path/to/cache <span class="nb">.</span>
</code></pre></div></div>

<h3 id="allow">Allow extra privileged entitlement (--allow)</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--allow=ENTITLEMENT
</code></pre></div></div>

<p>Allow extra privileged entitlement. List of entitlements:</p>

<ul>
  <li><code class="highlighter-rouge">network.host</code> - Allows executions with host networking.</li>
  <li><code class="highlighter-rouge">security.insecure</code> - Allows executions without sandbox. See
<a href="https://github.com/moby/buildkit/blob/master/frontend/dockerfile/docs/experimental.md#run---securityinsecuresandbox">related Dockerfile extensions</a>.</li>
</ul>

<p>For entitlements to be enabled, the <code class="highlighter-rouge">buildkitd</code> daemon also needs to allow them
with <code class="highlighter-rouge">--allow-insecure-entitlement</code> (see <a href="/engine/reference/commandline/buildx_create/#--buildkitd-flags-flags"><code class="highlighter-rouge">create --buildkitd-flags</code></a>)</p>

<p><strong>Examples</strong></p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker buildx create <span class="nt">--use</span> <span class="nt">--name</span> insecure-builder <span class="nt">--buildkitd-flags</span> <span class="s1">'--allow-insecure-entitlement security.insecure'</span>
<span class="gp">$</span> docker buildx build <span class="nt">--allow</span> security.insecure <span class="nb">.</span>
</code></pre></div></div>

<h2 id="parent-command">Parent command</h2>

<table>
  <thead>
    <tr>
      <th>Command</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="/engine/reference/commandline/buildx/">docker buildx</a></td>
      <td>Build with BuildKit</td>
    </tr>
  </tbody>
</table>

<h2 id="related-commands">Related commands</h2>

<table>
<thead>
  <tr>
    <td>Command</td>
    <td>Description</td>
  </tr>
</thead>
<tbody>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_bake/">docker buildx bake</a></td>
    <td>Build from a file</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_build/">docker buildx build</a></td>
    <td>Start a build</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_create/">docker buildx create</a></td>
    <td>Create a new builder instance</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_du/">docker buildx du</a></td>
    <td>Disk usage</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_imagetools/">docker buildx imagetools</a></td>
    <td>Commands to work on images in registry</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_inspect/">docker buildx inspect</a></td>
    <td>Inspect current builder instance</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_ls/">docker buildx ls</a></td>
    <td>List builder instances</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_prune/">docker buildx prune</a></td>
    <td>Remove build cache</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_rm/">docker buildx rm</a></td>
    <td>Remove a builder instance</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_stop/">docker buildx stop</a></td>
    <td>Stop builder instance</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_use/">docker buildx use</a></td>
    <td>Set the current builder instance</td>
  </tr>

  
  <tr>
    <td><a href="/engine/reference/commandline/buildx_version/">docker buildx version</a></td>
    <td>Show buildx version information</td>
  </tr>

</tbody>
</table>

<div class="ratings-div"><div id="pd_rating_holder_8453675"></div></div></section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
                                <ul class="nav hidden-md hidden-lg"></ul>
                                <ul class="nav" id="jsTOCLeftNav"></ul>
                            </div>
                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul><li><a href="https://github.com/docker/cli/tree/master/docs/reference/commandline"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit this page</a></li><li><a href="https://github.com/docker/docker.github.io/issues/new?body=File: [engine/reference/commandline/buildx_build.md](https://docs.docker.com/engine/reference/commandline/buildx_build/)" class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> Request docs changes</a></li>
                                        <li><div class="toggle-mode">
  <div class="icon">
      <i class="fa fa-sun-o" aria-hidden="true"></i>
  </div>
  <div class="toggle-switch">
      <label class="switch">
          <input type="checkbox" id="switch-style">
          <span class="slider round"></span>
      </label>
  </div>
  <div class="icon">
      <i class="fa fa-moon-o" aria-hidden="true"></i>
  </div>
</div>
</li>
                                    </ul>
                                </div><div id="side-toc-title">On this page:</div>
<ul id="my_toc" class="inline_toc">
  <li><a href="#description" class="nomunge">Description</a></li>
  <li><a href="#usage" class="nomunge">Usage</a></li>
  <li><a href="#extended-description" class="nomunge">Extended description</a></li>
  <li><a href="#options" class="nomunge">Options</a></li>
  <li><a href="#examples" class="nomunge">Examples</a>
    <ul>
      <li><a href="#platform" class="nomunge">Set the target platforms for the build (--platform)</a></li>
      <li><a href="#output" class="nomunge">Set the export action for the build result (-o, --output)</a></li>
      <li><a href="#push" class="nomunge">Push the build result to a registry (--push)</a></li>
      <li><a href="#load" class="nomunge">Load the single-platform build result to docker images (--load)</a></li>
      <li><a href="#cache-from" class="nomunge">Use an external cache source for a build (--cache-from)</a></li>
      <li><a href="#cache-to" class="nomunge">Export build cache to an external cache destination (--cache-to)</a></li>
      <li><a href="#allow" class="nomunge">Allow extra privileged entitlement (--allow)</a></li>
    </ul>
  </li>
  <li><a href="#parent-command" class="nomunge">Parent command</a></li>
  <li><a href="#related-commands" class="nomunge">Related commands</a></li>
</ul>

</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker?</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container?</a></li>
                        <li><a href="https://docker.events.cube365.net/dockercon/">DockerCon</a></li>
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><a href="https://www.docker.com/roadmap">Docker Product Roadmap</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Pricing</a></b></li>
                        <li><a href="https://www.docker.com/pricing/faq">FAQs</a></li>
                        <li><a href="https://www.docker.com/partners/programs">Docker Verified Publisher Program</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank" rel="noopener">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank" rel="noopener">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2021 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <script>const pageURL = "/engine/reference/commandline/buildx_build/";</script><script>
    let PDRTJS_settings_8453675 = {
        "id": "8453675",
        "unique_id": "engine/reference/commandline/buildx_build.md",
        "title": "docker buildx build",
        "font_family": "Open Sans, sans serif",
        "font_color": "b9c2cc",
        "font_align": "center",
        "permalink": "https://github.com/docker/docker.github.io/blob/master/engine/reference/commandline/buildx_build.md"
    };
    (function (d, c, j) {
        if (!document.getElementById(j)) {
            let pd=d.createElement(c),s;pd.id=j;pd.src='https://polldaddy.com/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd, s);
        }
    }(document, 'script', 'pd-rating-js'));
</script></body>
</html>

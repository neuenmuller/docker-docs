<!-- Page generated 2021-11-17 12:16:07 +0000-->
<!DOCTYPE html>
<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>
<title>Use the ZFS storage driver | Docker Documentation</title>
  <meta name="description" content="Learn how to optimize your use of ZFS driver." />
  <meta name="keywords" content="container, storage, driver, ZFS ">
  <link rel="canonical" href="https://docs.docker.com/storage/storagedriver/zfs-driver/" />

  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/favicons/docs@2x.ico" sizes="129x128">
  <link rel="apple-touch-icon" type="image/x-icon" href="/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/favicons/docs@2x.ico">
  <meta property="og:image" content="/favicons/docs@2x.ico"/>
  <meta name="theme-color" content="#2496ed" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- hide elements that are only shown without JavaScript enabled -->
  <script>document.documentElement.classList.add('js')</script>
  <style>html.js .no-js { display: none !important; }</style><script defer src="/js/theme-switcher.js"></script>
  <script defer src="/js/anchorlinks.js"></script>
  <script defer src="/js/jquery.js"></script>
  <script defer src="/js/bootstrap.min.js"></script>
  <script defer src="/js/docs.js"></script><script defer src="/js/search.js"></script><link rel="preload" as="font" href="https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFVZ0bf8pkAg.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/fonts/geomanist/hinted-Geomanist-Book.woff2"    type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/fonts/geomanist/hinted-Geomanist-Regular.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/fonts/glyphicons-halflings-regular.woff2"       type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/fonts/fontawesome-webfont.woff2?v=4.7.0"        type="font/woff2" crossorigin="anonymous">

  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css" id="pagestyle">

  <!-- SEO stuff -->
  <meta name="twitter:title" itemprop="title name" content="Use the ZFS storage driver"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="" />
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:domain" content="docs.docker.com"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:image:src" content="https://docs.docker.com/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker Documentation"/>
  <meta property="og:title" content="Use the ZFS storage driver" />
  <meta property="og:description" content="Learn how to optimize your use of ZFS driver." />
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2021-11-17T12:16:07+00:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="https://docs.docker.com/images/docs@2x.png"/>
  <meta property="og:locale" content="en_US" />
  <meta property="og:url" content="https://docs.docker.com/storage/storagedriver/zfs-driver/" />
  <meta property="og:site_name" content="Docker Documentation" />
  <meta property="article:published_time" itemprop="datePublished" content="2021-11-17T12:16:07+00:00"/>
  <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"Use the ZFS storage driver","description":"Learn how to optimize your use of ZFS driver.","url":"https://docs.docker.com/storage/storagedriver/zfs-driver/"}</script>
  <!-- END SEO STUFF -->
</head>
<body class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/">
                <img class="logo" src="/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs" width="160" height="28" />
            </a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="logo-mobile">
    <a href="/">
        <img src="/images/docker-icon.svg" alt="Docker Docs" title="Docker Docs" width="30" height="30" />
    </a>
</div>
<div class="search-form" id="search-div">
    <form class="search-form form-inline" id="searchForm" action="/search/" method="get">
        <label for="st-search-input" class="sr-only">Search</label>
        <input class="search-field form-control ds-input" id="st-search-input" name="q" placeholder="Search the docs" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteResults"></div>
        <!-- <button type="submit" class="search-submit btn btn-default">Search</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container hidden-sm hidden-xs">
    <div>
        <ul class="nav navbar-nav"><li><a href="/" id="home">Home</a></li><li><a href="/get-started/overview/" id="guides">Guides</a></li><li><a href="/desktop/" id="manuals">Manuals</a></li><li><a href="/reference/" id="reference">Reference</a></li><li><a href="/samples/" id="samples">Samples</a></li></ul>
    </div>
    <div class="ctrl-right">
        <a href="javascript:void(0)" id="menu-toggle" aria-label="Current page's menu toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
    </div>
</div>
<div class="row hidden-sm hidden-xs">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li><a href="/" title="Docker docs homepage"><i class="fa fa-home"></i></a></li>
            <li><a href="/get-started/overview/">Guides</a></li><li><a>Run your app in production</a></li><li><a href="/storage/">Manage application data</a></li><li><a href="/storage/storagedriver/">Store data within containers</a></li><li><a href="/storage/storagedriver/zfs-driver/">Use the ZFS storage driver</a></li></ol>
    </nav>
</div></div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section"><h1>Use the ZFS storage driver</h1><p><em class="reading-time">Estimated reading time: 9 minutes</em></p><p>ZFS is a next generation filesystem that supports many advanced storage
technologies such as volume management, snapshots, checksumming, compression and
deduplication, replication and more.</p>

<p>It was created by Sun Microsystems (now Oracle Corporation) and is open sourced
under the CDDL license. Due to licensing incompatibilities between the CDDL and
GPL, ZFS cannot be shipped as part of the mainline Linux kernel. However, the
ZFS On Linux (ZoL) project provides an out-of-tree kernel module and userspace
tools which can be installed separately.</p>

<p>The ZFS on Linux (ZoL) port is healthy and maturing. However, at this point in
time it is not recommended to use the <code class="highlighter-rouge">zfs</code> Docker storage driver for production
use unless you have substantial experience with ZFS on Linux.</p>

<blockquote>
  <p><strong><em>Note</em></strong>: There is also a FUSE implementation of ZFS on the Linux platform.
This is not recommended. The native ZFS driver (ZoL) is more tested, more
performant, and is more widely used. The remainder  of this document refers
to the native ZoL port.</p>
</blockquote>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
  <li>ZFS requires one or more dedicated block devices, preferably solid-state
drives (SSDs).</li>
  <li>ZFS is only supported on Docker Engine - Community with Ubuntu 14.04 or higher, with the <code class="highlighter-rouge">zfs</code>
package (16.04 and higher) or <code class="highlighter-rouge">zfs-native</code> and <code class="highlighter-rouge">ubuntu-zfs</code> packages (14.04)
installed.
    <ul>
      <li>For Ubuntu 14.04, you need to enable a supplemental package repository
<code class="highlighter-rouge">ppa:zfs-native/stable</code> before you can install the package. See
<a href="https://launchpad.net/~zfs-native/+archive/ubuntu/stable" target="_blank" rel="noopener" class="_">https://launchpad.net/~zfs-native/+archive/ubuntu/stable</a>
for instructions.</li>
    </ul>
  </li>
  <li>ZFS is not supported on Docker EE or CS-Engine, or any other Linux platforms.</li>
  <li>The <code class="highlighter-rouge">/var/lib/docker/</code> directory must be mounted on a ZFS-formatted
filesystem.</li>
  <li>Changing the storage driver makes any containers you have already
created inaccessible on the local system. Use <code class="highlighter-rouge">docker save</code> to save containers,
and push existing images to Docker Hub or a private repository, so that you
do not need to re-create them later.</li>
</ul>

<blockquote>
  <p><strong>Note</strong></p>

  <p>There is no need to use <code class="highlighter-rouge">MountFlags=slave</code> with Docker Engine 18.09 or
later because <code class="highlighter-rouge">dockerd</code> and <code class="highlighter-rouge">containerd</code> are in different mount namespaces.</p>
</blockquote>

<h2 id="configure-docker-with-the-zfs-storage-driver">Configure Docker with the <code class="highlighter-rouge">zfs</code> storage driver</h2>

<ol>
  <li>
    <p>Stop Docker.</p>
  </li>
  <li>
    <p>Copy the contents of <code class="highlighter-rouge">/var/lib/docker/</code> to <code class="highlighter-rouge">/var/lib/docker.bk</code> and remove
the contents of <code class="highlighter-rouge">/var/lib/docker/</code>.</p>

    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> <span class="nb">sudo </span>cp <span class="nt">-au</span> /var/lib/docker /var/lib/docker.bk
<span class="go">
</span><span class="gp">$</span> <span class="nb">sudo </span>rm <span class="nt">-rf</span> /var/lib/docker/<span class="k">*</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a new <code class="highlighter-rouge">zpool</code> on your dedicated block device or devices, and mount it
into <code class="highlighter-rouge">/var/lib/docker/</code>. Be sure you
have specified the correct devices, because this is a destructive operation.
This example adds two devices to the pool.</p>

    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> <span class="nb">sudo </span>zpool create <span class="nt">-f</span> zpool-docker <span class="nt">-m</span> /var/lib/docker /dev/xvdf /dev/xvdg
</code></pre></div>    </div>

    <p>The command creates the <code class="highlighter-rouge">zpool</code> and names it <code class="highlighter-rouge">zpool-docker</code>. The name is for
display purposes only, and you can use a different name. Check that the pool
was created and mounted correctly using <code class="highlighter-rouge">zfs list</code>.</p>

    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> <span class="nb">sudo </span>zfs list
<span class="go">
NAME           USED  AVAIL  REFER  MOUNTPOINT
zpool-docker    55K  96.4G    19K  /var/lib/docker
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>Configure Docker to use <code class="highlighter-rouge">zfs</code>. Edit <code class="highlighter-rouge">/etc/docker/daemon.json</code> and set the
<code class="highlighter-rouge">storage-driver</code> to <code class="highlighter-rouge">zfs</code>. If the file was empty before, it should now look
like this:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"storage-driver"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zfs"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>

    <p>Save and close the file.</p>
  </li>
  <li>
    <p>Start Docker. Use <code class="highlighter-rouge">docker info</code> to verify that the storage driver is <code class="highlighter-rouge">zfs</code>.</p>

    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> <span class="nb">sudo </span>docker info
<span class="go">  Containers: 0
   Running: 0
   Paused: 0
   Stopped: 0
  Images: 0
  Server Version: 17.03.1-ce
  Storage Driver: zfs
   Zpool: zpool-docker
   Zpool Health: ONLINE
   Parent Dataset: zpool-docker
   Space Used By Parent: 249856
   Space Available: 103498395648
   Parent Quota: no
   Compression: off
</span><span class="c">&lt;...&gt;
</span></code></pre></div>    </div>
  </li>
</ol>

<h2 id="manage-zfs">Manage <code class="highlighter-rouge">zfs</code></h2>

<h3 id="increase-capacity-on-a-running-device">Increase capacity on a running device</h3>

<p>To increase the size of the <code class="highlighter-rouge">zpool</code>, you need to add a dedicated block device to
the Docker host, and then add it to the <code class="highlighter-rouge">zpool</code> using the <code class="highlighter-rouge">zpool add</code> command:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> <span class="nb">sudo </span>zpool add zpool-docker /dev/xvdh
</code></pre></div></div>

<h3 id="limit-a-containers-writable-storage-quota">Limit a container’s writable storage quota</h3>

<p>If you want to implement a quota on a per-image/dataset basis, you can set the
<code class="highlighter-rouge">size</code> storage option to limit the amount of space a single container can use
for its writable layer.</p>

<p>Edit <code class="highlighter-rouge">/etc/docker/daemon.json</code> and add the following:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"storage-driver"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zfs"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"storage-opts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"size=256M"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>See all storage options for each storage driver in the
<a href="/engine/reference/commandline/dockerd/#daemon-storage-driver">daemon reference documentation</a></p>

<p>Save and close the file, and restart Docker.</p>

<h2 id="how-the-zfs-storage-driver-works">How the <code class="highlighter-rouge">zfs</code> storage driver works</h2>

<p>ZFS uses the following objects:</p>

<ul>
  <li><strong>filesystems</strong>: thinly provisioned, with space allocated from the <code class="highlighter-rouge">zpool</code> on
demand.</li>
  <li><strong>snapshots</strong>: read-only space-efficient point-in-time copies of filesystems.</li>
  <li><strong>clones</strong>: Read-write copies of snapshots. Used for storing the differences
from the previous layer.</li>
</ul>

<p>The process of creating a clone:</p>

<p><img src="/storage/storagedriver/images/zfs_clones.jpg" alt="zfs snapshots and clones" /></p>

<ol>
  <li>A read-only snapshot is created from the filesystem.</li>
  <li>A writable clone is created from the snapshot. This contains any differences
from the parent layer.</li>
</ol>

<p>Filesystems, snapshots, and clones all allocate space from the underlying
<code class="highlighter-rouge">zpool</code>.</p>

<h3 id="image-and-container-layers-on-disk">Image and container layers on-disk</h3>

<p>Each running container’s unified filesystem is mounted on a mount point in
<code class="highlighter-rouge">/var/lib/docker/zfs/graph/</code>. Continue reading for an explanation of how the
unified filesystem is composed.</p>

<h3 id="image-layering-and-sharing">Image layering and sharing</h3>

<p>The base layer of an image is a ZFS filesystem. Each child layer is a ZFS clone
based on a ZFS snapshot of the layer below it. A container is a ZFS clone based
on a ZFS Snapshot of the top layer of the image it’s created from.</p>

<p>The diagram below shows how this is put together with a running container based
on a two-layer image.</p>

<p><img src="/storage/storagedriver/images/zfs_zpool.jpg" alt="zfs pool for Docker container" /></p>

<p>When you start a container, the following steps happen in order:</p>

<ol>
  <li>
    <p>The base layer of the image exists on the Docker host as a ZFS filesystem.</p>
  </li>
  <li>
    <p>Additional image layers are clones of the dataset hosting the image layer
directly below it.</p>

    <p>In the diagram, “Layer 1” is added by taking a ZFS snapshot of the base
layer and then creating a clone from that snapshot. The clone is writable and
consumes space on-demand from the zpool. The snapshot is read-only,
maintaining the base layer as an immutable object.</p>
  </li>
  <li>
    <p>When the container is launched, a writable layer is added above the image.</p>

    <p>In the diagram, the container’s read-write layer is created by making
a snapshot of the top layer of the image (Layer 1) and creating a clone from
that snapshot.</p>
  </li>
  <li>
    <p>As the container modifies the contents of its writable layer, space is
allocated for the blocks that are changed. By default, these blocks are
128k.</p>
  </li>
</ol>

<h2 id="how-container-reads-and-writes-work-with-zfs">How container reads and writes work with <code class="highlighter-rouge">zfs</code></h2>

<h3 id="reading-files">Reading files</h3>

<p>Each container’s writable layer is a ZFS clone which shares all its data with
the dataset it was created from (the snapshots of its parent layers). Read
operations are fast, even if the data being read is from a deep layer.
This diagram illustrates how block sharing works:</p>

<p><img src="/storage/storagedriver/images/zpool_blocks.jpg" alt="zfs block sharing" /></p>

<h3 id="writing-files">Writing files</h3>

<p><strong>Writing a new file</strong>: space is allocated on demand from the underlying <code class="highlighter-rouge">zpool</code>
and the blocks are written directly into the container’s writable layer.</p>

<p><strong>Modifying an existing file</strong>: space is allocated only for the changed blocks,
and those blocks are written into the container’s writable layer using a
copy-on-write (CoW) strategy. This minimizes the size of the layer and increases
write performance.</p>

<p><strong>Deleting a file or directory</strong>:</p>
<ul>
  <li>When you delete a file or directory that exists in a lower layer, the ZFS
driver masks the existence of the file or directory in the container’s
writable layer, even though the file or directory still exists in the lower
read-only layers.</li>
  <li>If you create and then delete a file or directory within the container’s
writable layer, the blocks are reclaimed by the <code class="highlighter-rouge">zpool</code>.</li>
</ul>

<h2 id="zfs-and-docker-performance">ZFS and Docker performance</h2>

<p>There are several factors that influence the performance of Docker using the
<code class="highlighter-rouge">zfs</code> storage driver.</p>

<ul>
  <li>
    <p><strong>Memory</strong>: Memory has a major impact on ZFS performance. ZFS was originally
designed for large enterprise-grade servers with a large amount of memory.</p>
  </li>
  <li>
    <p><strong>ZFS Features</strong>: ZFS includes a de-duplication feature. Using this feature
may save disk space, but uses a large amount of memory. It is recommended that
you disable this feature for the <code class="highlighter-rouge">zpool</code> you are using with Docker, unless you
are using SAN, NAS, or other hardware RAID technologies.</p>
  </li>
  <li>
    <p><strong>ZFS Caching</strong>: ZFS caches disk blocks in a memory structure called the
adaptive replacement cache (ARC). The <em>Single Copy ARC</em> feature of ZFS allows
a single cached copy of a block to be shared by multiple clones of a
With this feature, multiple running containers can share a single copy of a
cached block. This feature makes ZFS a good option for PaaS and other
high-density use cases.</p>
  </li>
  <li>
    <p><strong>Fragmentation</strong>: Fragmentation is a natural byproduct of copy-on-write
filesystems like ZFS. ZFS mitigates this by using a small block size of 128k.
The ZFS intent log (ZIL) and the coalescing of writes (delayed writes) also
help to reduce fragmentation. You can monitor fragmentation using
<code class="highlighter-rouge">zpool status</code>. However, there is no way to defragment ZFS without reformatting
and restoring the filesystem.</p>
  </li>
  <li>
    <p><strong>Use the native ZFS driver for Linux</strong>: The ZFS FUSE implementation is not
recommended, due to poor performance.</p>
  </li>
</ul>

<h3 id="performance-best-practices">Performance best practices</h3>

<ul>
  <li>
    <p><strong>Use fast storage</strong>:  Solid-state drives (SSDs) provide faster reads and
writes than spinning disks.</p>
  </li>
  <li>
    <p><strong>Use volumes for write-heavy workloads</strong>: Volumes provide the best and most
predictable performance for write-heavy workloads. This is because they bypass
the storage driver and do not incur any of the potential overheads introduced
by thin provisioning and copy-on-write. Volumes have other benefits, such as
allowing you to share data among containers and persisting even when no
running container is using them.</p>
  </li>
</ul>

<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="/search/?q=container">container</a>, <a href="/search/?q=storage">storage</a>, <a href="/search/?q=driver">driver</a>, <a href="/search/?q=ZFS">ZFS</a></span><div class="ratings-div"><div id="pd_rating_holder_8453675"></div></div></section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
                                <ul class="nav hidden-md hidden-lg"></ul>
                                <ul class="nav" id="jsTOCLeftNav"></ul>
                            </div>
                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul><li><a href="https://github.com/docker/docker.github.io/edit/master/storage/storagedriver/zfs-driver.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit this page</a></li><li><a href="https://github.com/docker/docker.github.io/issues/new?body=File: [storage/storagedriver/zfs-driver.md](https://docs.docker.com/storage/storagedriver/zfs-driver/)" class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> Request docs changes</a></li>
                                        <li><div class="toggle-mode">
  <div class="icon">
      <i class="fa fa-sun-o" aria-hidden="true"></i>
  </div>
  <div class="toggle-switch">
      <label class="switch">
          <input type="checkbox" id="switch-style">
          <span class="slider round"></span>
      </label>
  </div>
  <div class="icon">
      <i class="fa fa-moon-o" aria-hidden="true"></i>
  </div>
</div>
</li>
                                    </ul>
                                </div><div id="side-toc-title">On this page:</div>
<ul id="my_toc" class="inline_toc">
  <li><a href="#prerequisites" class="nomunge">Prerequisites</a></li>
  <li><a href="#configure-docker-with-the-zfs-storage-driver" class="nomunge">Configure Docker with the zfs storage driver</a></li>
  <li><a href="#manage-zfs" class="nomunge">Manage zfs</a>
    <ul>
      <li><a href="#increase-capacity-on-a-running-device" class="nomunge">Increase capacity on a running device</a></li>
      <li><a href="#limit-a-containers-writable-storage-quota" class="nomunge">Limit a container’s writable storage quota</a></li>
    </ul>
  </li>
  <li><a href="#how-the-zfs-storage-driver-works" class="nomunge">How the zfs storage driver works</a>
    <ul>
      <li><a href="#image-and-container-layers-on-disk" class="nomunge">Image and container layers on-disk</a></li>
      <li><a href="#image-layering-and-sharing" class="nomunge">Image layering and sharing</a></li>
    </ul>
  </li>
  <li><a href="#how-container-reads-and-writes-work-with-zfs" class="nomunge">How container reads and writes work with zfs</a>
    <ul>
      <li><a href="#reading-files" class="nomunge">Reading files</a></li>
      <li><a href="#writing-files" class="nomunge">Writing files</a></li>
    </ul>
  </li>
  <li><a href="#zfs-and-docker-performance" class="nomunge">ZFS and Docker performance</a>
    <ul>
      <li><a href="#performance-best-practices" class="nomunge">Performance best practices</a></li>
    </ul>
  </li>
</ul>

</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker?</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container?</a></li>
                        <li><a href="https://docker.events.cube365.net/dockercon/">DockerCon</a></li>
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><a href="https://www.docker.com/roadmap">Docker Product Roadmap</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Pricing</a></b></li>
                        <li><a href="https://www.docker.com/pricing/faq">FAQs</a></li>
                        <li><a href="https://www.docker.com/partners/programs">Docker Verified Publisher Program</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank" rel="noopener">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank" rel="noopener">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2021 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <script>const pageURL = "/storage/storagedriver/zfs-driver/";</script><script>
    let PDRTJS_settings_8453675 = {
        "id": "8453675",
        "unique_id": "storage/storagedriver/zfs-driver.md",
        "title": "Use the ZFS storage driver",
        "font_family": "Open Sans, sans serif",
        "font_color": "b9c2cc",
        "font_align": "center",
        "permalink": "https://github.com/docker/docker.github.io/blob/master/storage/storagedriver/zfs-driver.md"
    };
    (function (d, c, j) {
        if (!document.getElementById(j)) {
            let pd=d.createElement(c),s;pd.id=j;pd.src='https://polldaddy.com/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd, s);
        }
    }(document, 'script', 'pd-rating-js'));
</script></body>
</html>
